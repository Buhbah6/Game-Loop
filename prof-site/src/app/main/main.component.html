<div class="home">

  <!-- Main Content Grid -->
  <section class="main">
    <div class="container">
      <div class="content-grid">
        <!-- Left Column - Featured Article & Recent Articles -->
        <div class="main-content">

          <!-- Featured Article -->
          @if (featuredArticle$ | async; as article) {
            <div class="featured-article">
              <div class="article-card featured" (click)="navigateToArticle(article)">
                <div class="article-image">
                  @if (article.coverImage?.url) {
                    <img [src]="'http://localhost:1337' + article.coverImage!.url" [alt]="article.title" 
                         style="width: 100%; height: 100%; object-fit: cover;" />
                  } @else {
                    <div class="article-image-placeholder">
                      <div class="code-preview">
                        <div class="code-line">const player = {{ '{' }}</div>
                        <div class="code-line">&nbsp;&nbsp;health: 100,</div>
                        <div class="code-line">&nbsp;&nbsp;position: {{ '{' }} x: 0, y: 0 {{ '}' }},</div>
                        <div class="code-line">&nbsp;&nbsp;velocity: {{ '{' }} x: 0, y: 0 {{ '}' }},</div>
                        <div class="code-line">&nbsp;&nbsp;// Player engagement logic</div>
                        <div class="code-line">&nbsp;&nbsp;updateRewardSystem() {{ '{' }}</div>
                        <div class="code-line">&nbsp;&nbsp;&nbsp;&nbsp;this.rewards.push('achievement');</div>
                        <div class="code-line">&nbsp;&nbsp;{{ '}' }}</div>
                        <div class="code-line">{{ '}' }};</div>
                      </div>
                    </div>
                  }
                </div>
                <div class="article-content">
                  <div class="article-tags">
                    <span class="tag tag-featured">Featured</span>
                    <span class="tag tag-game-design">Game Design</span>
                  </div>
                  <h3 class="article-title">{{ article.title }}</h3>
                  <p class="article-excerpt">{{ article.summary || 'No summary available' }}</p>
                  <div class="article-meta">
                    <div class="article-date">
                      üìÖ {{ (article.publishedAt | date:'MMM d') || 'Recent' }}
                    </div>
                  </div>
                  <a href="#" class="read-more">Read Full Article ‚Üí</a>
                </div>
              </div>
            </div>
          }

          <!-- Recent Articles Grid -->
          <div class="article-grid">
            @for (article of recentArticles$ | async; track article.id; let i = $index) {
              <div class="article-card" (click)="navigateToArticle(article)">
                  <div class="article-image">
                    @if (article.coverImage?.url) {
                      <img [src]="'http://localhost:1337' + article.coverImage!.url" [alt]="article.title" 
                           style="width: 100%; height: 100%; object-fit: cover;" />
                    } @else {
                      @if (i === 0) {
                        <!-- World Building -->
                        <div class="gradient-bg purple">
                          <div class="article-visual">
                            <div class="planet-icon">üåç</div>
                          </div>
                        </div>
                        <div class="article-category">World Building</div>
                      } @else if (i === 1) {
                        <!-- Game Balance -->
                        <div class="code-bg">
                          <div class="mini-code">
                            <div class="code-line">if (player.health &lt; 50) {{ '{' }}</div>
                            <div class="code-line">&nbsp;&nbsp;showWarning();</div>
                            <div class="code-line">{{ '}' }}</div>
                          </div>
                        </div>
                        <div class="article-category">Game Balance</div>
                      } @else if (i === 2) {
                        <!-- Marketing -->
                        <div class="code-bg">
                          <div class="mini-code">
                            <div class="code-line">const marketing = {{ '{' }}</div>
                            <div class="code-line">&nbsp;&nbsp;strategy: 'viral'</div>
                            <div class="code-line">{{ '}' }};</div>
                          </div>
                        </div>
                        <div class="article-category">Marketing</div>
                      } @else if (i === 3) {
                        <!-- Programming -->
                        <div class="gradient-bg purple">
                          <div class="article-visual">
                            <div class="code-symbol">{{ '{' }} {{ '}' }}</div>
                          </div>
                        </div>
                        <div class="article-category">Programming</div>
                      } @else {
                        <!-- Default -->
                        <div class="gradient-bg purple">
                          <div class="article-visual">
                            <div class="material-icons game-icon">sports_esports</div>
                          </div>
                        </div>
                        <div class="article-category">Development</div>
                      }
                    }
                  </div>
                  <div class="article-content">
                    <h4 class="article-title">{{ article.title }}</h4>
                    <p class="article-excerpt">{{ article.summary || 'No summary available' }}</p>
                    <div class="article-meta">
                      <div class="article-date">üìÖ {{ (article.publishedAt | date:'MMM d') || 'Recent' }}</div>
                    </div>
                    <a href="#" class="read-more">Read More ‚Üí</a>
                  </div>
                </div>
            }
          </div>
          
          <!-- See All Articles Button -->
          @if (allArticles$ | async; as allArticles) {
            @if (!showAllArticles && allArticles.length > 7) {
              <div class="see-all-section">
                <button class="see-all-btn" (click)="toggleShowAllArticles()">
                  <span class="material-icons">article</span> See All Articles ({{ allArticles.length - 1 }} total)
                </button>
              </div>
            } @else if (showAllArticles) {
              <div class="see-all-section">
                <button class="see-all-btn" (click)="toggleShowAllArticles()">
                  <span class="material-icons">article</span> Show Less Articles
                </button>
              </div>
            }
          }
        </div>

        <!-- Right Sidebar -->
        <div class="sidebar">
          <!-- Latest Tutorials -->
          <div class="sidebar-section">
            <h3 class="sidebar-title">
              <span class="code-icon">{{ '{' }} {{ '}' }}</span>
              Latest Tutorials
            </h3>
            
            @for (tutorial of latestTutorials$ | async; track tutorial.id; let i = $index) {
              <div class="tutorial-card" (click)="navigateToTutorial(tutorial)">
                  <div class="tutorial-image">
                    @if (tutorial.coverImage && tutorial.coverImage.length > 0) {
                      <img [src]="'http://localhost:1337' + tutorial.coverImage[0].url" [alt]="tutorial.title" 
                           style="width: 100%; height: 100%; object-fit: cover;" />
                      @if (i === 0) {
                        <div class="tutorial-badge new">New</div>
                      }
                    } @else {
                      @if (i === 0) {
                        <div class="gradient-bg unity"><span class="material-icons">sports_esports</span></div>
                        <div class="tutorial-category unity">Unity</div>
                        <div class="tutorial-badge new">New</div>
                      } @else if (i === 1) {
                        <div class="code-bg small">
                          <div class="mini-code">
                            <div class="code-line">createPixelArt()</div>
                          </div>
                        </div>
                        <div class="tutorial-category art">Art</div>
                      } @else if (i === 2) {
                        <div class="gradient-bg audio">üéµ</div>
                        <div class="tutorial-category audio">Audio</div>
                      } @else if (i === 3) {
                        <div class="code-bg small">
                          <div class="mini-code">
                            <div class="code-line">balanceAI()</div>
                          </div>
                        </div>
                        <div class="tutorial-category ai">AI</div>
                      } @else {
                        <div class="gradient-bg mobile"><span class="material-icons">smartphone</span></div>
                        <div class="tutorial-category mobile">Mobile</div>
                      }
                    }
                  </div>
                  <div class="tutorial-content">
                    <h4 class="tutorial-title">{{ tutorial.title }}</h4>
                    <div class="tutorial-meta">
                      <div class="tutorial-date">
                        üìÖ {{ (tutorial.publishedAt | date:'MMM d') || 'Recent' }}
                      </div>
                    </div>
                    <a href="#" class="start-tutorial">Start Tutorial ‚Üí</a>
                  </div>
                </div>
            }

            <div class="view-all">
              @if (allTutorials$ | async; as allTutorials) {
                @if (!showAllTutorials && allTutorials.length > 5) {
                  <button class="view-all-btn" (click)="toggleShowAllTutorials()">
                    üëÅÔ∏è Show All Tutorials ({{ allTutorials.length }} total)
                  </button>
                } @else if (showAllTutorials) {
                  <button class="view-all-btn" (click)="toggleShowAllTutorials()">
                    üëÅÔ∏è Show Less Tutorials
                  </button>
                } @else {
                  <a href="#" class="view-all-link" (click)="navigateToTutorials()">
                    üëÅÔ∏è View All Tutorials ‚Üí
                  </a>
                }
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>